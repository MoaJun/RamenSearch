const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/RamenShopDetail-Da1LbrLU.js","assets/ui-D1brmElj.js","assets/vendor-D3F3s8fL.js","assets/ReviewSummary-B4aI4XXt.js","assets/ai-8rzRUgYl.js","assets/MyPage-BLBj1JDJ.js","assets/RamenShopListItem-DSriu-Ab.js","assets/SearchPage-1U4Gp4kz.js","assets/googleMaps-dUlr1ba2.js","assets/google-maps-93e-Jyro.js"])))=>i.map(i=>d[i]);
import{r as Ee,a as ke,g as je}from"./vendor-D3F3s8fL.js";import{M as Te,r as i,X as ae,I as Ne,L as Fe,S as Me,C as Ce,R as P,H as Oe,U as Re}from"./ui-D1brmElj.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();var J={exports:{}},C={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oe;function Ae(){if(oe)return C;oe=1;var n=Ee(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(u,d,h){var p,m={},f=null,w=null;h!==void 0&&(f=""+h),d.key!==void 0&&(f=""+d.key),d.ref!==void 0&&(w=d.ref);for(p in d)s.call(d,p)&&!o.hasOwnProperty(p)&&(m[p]=d[p]);if(u&&u.defaultProps)for(p in d=u.defaultProps,d)m[p]===void 0&&(m[p]=d[p]);return{$$typeof:e,type:u,key:f,ref:w,props:m,_owner:r.current}}return C.Fragment=t,C.jsx=l,C.jsxs=l,C}var ie;function Ve(){return ie||(ie=1,J.exports=Ae()),J.exports}var a=Ve(),V={},ne;function $e(){if(ne)return V;ne=1;var n=ke();return V.createRoot=n.createRoot,V.hydrateRoot=n.hydrateRoot,V}var Ue=$e();const Pe=je(Ue),Le="modulepreload",qe=function(n){return"/"+n},ce={},Y=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){let l=function(h){return Promise.all(h.map(p=>Promise.resolve(p).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),d=u?.nonce||u?.getAttribute("nonce");r=l(t.map(h=>{if(h=qe(h),h in ce)return;ce[h]=!0;const p=h.endsWith(".css"),m=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${m}`))return;const f=document.createElement("link");if(f.rel=p?"stylesheet":Le,p||(f.as="script"),f.crossOrigin="",f.href=h,d&&f.setAttribute("nonce",d),document.head.appendChild(f),p)return new Promise((w,k)=>{f.addEventListener("load",w),f.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${h}`)))})}))}function o(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return r.then(l=>{for(const u of l||[])u.status==="rejected"&&o(u.reason);return e().catch(o)})},Be=[{placeId:"ch-1",name:"éººå±‹ é¾ã®å¿ƒ (Menya Ryunoshin)",photos:[{small:"https://picsum.photos/seed/ramen1-main/400/300",medium:"https://picsum.photos/seed/ramen1-main/800/600",large:"https://picsum.photos/seed/ramen1-main/1200/900",alt:"é¾ã®å¿ƒãƒ©ãƒ¼ãƒ¡ãƒ³"},{small:"https://picsum.photos/seed/ramen1-side/400/300",medium:"https://picsum.photos/seed/ramen1-side/800/600",large:"https://picsum.photos/seed/ramen1-side/1200/900",alt:"ã‚µã‚¤ãƒ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®é¤ƒå­"},{small:"https://picsum.photos/seed/ramen1-shop/400/300",medium:"https://picsum.photos/seed/ramen1-shop/800/600",large:"https://picsum.photos/seed/ramen1-shop/1200/900",alt:"åº—èˆ—ã®å¤–è¦³"},{small:"https://picsum.photos/seed/ramen1-noodles/400/300",medium:"https://picsum.photos/seed/ramen1-noodles/800/600",large:"https://picsum.photos/seed/ramen1-noodles/1200/900",alt:"ãƒ©ãƒ¼ãƒ¡ãƒ³ã®éºº"}],rating:4.5,address:"æ±äº¬éƒ½æ–°å®¿åŒºè¥¿æ–°å®¿1-1-1",lat:35.690921,lng:139.700257,hours:"11:00 - 22:00",website:"https://example.com/ryunoshin",twitterUrl:"https://twitter.com/example_ramen",reviews:[{author:"ä½è—¤å¥",text:"æ¿ƒåšãªè±šéª¨ã‚¹ãƒ¼ãƒ—ãŒçµ¶å“ï¼ãƒãƒ£ãƒ¼ã‚·ãƒ¥ãƒ¼ãŒã¨ã‚ã‘ã‚‹ã‚ˆã†ã«æŸ”ã‚‰ã‹ãã€æ›¿ãˆç‰å¿…é ˆã§ã™ã€‚è¡Œåˆ—ãŒçµ¶ãˆãªã„ã®ã‚‚ç´å¾—ã€‚",rating:5,relative_time_description:"1é€±é–“å‰",time:1705276800},{author:"éˆ´æœ¨ä¸€éƒ",text:"ã“ã£ã¦ã‚Šå¥½ãã«ã¯ãŸã¾ã‚‰ãªã„ä¸€æ¯ã€‚éººã®ç¡¬ã•ã‚‚é¸ã¹ã¦æœ€é«˜ã§ã—ãŸã€‚ãƒ‹ãƒ³ãƒ‹ã‚¯ã‚’ãŸã£ã·ã‚Šå…¥ã‚Œã‚‹ã®ãŒãŠã™ã™ã‚ã€‚",rating:4,relative_time_description:"2é€±é–“å‰",time:1704672e3},{author:"é«˜æ©‹èŠ±å­",text:"ã‚¹ãƒ¼ãƒ—ã¯ç¾å‘³ã—ã‹ã£ãŸã§ã™ãŒã€å°‘ã—å‘³ãŒæ¿ƒã™ãã‚‹ã¨æ„Ÿã˜ã¾ã—ãŸã€‚åº—å†…ã®æ´»æ°—ã¯è‰¯ã‹ã£ãŸã§ã™ã€‚",rating:3,relative_time_description:"3é€±é–“å‰",time:1704067200},{author:"ç”°ä¸­å®ˆ",text:"é€±æœ«ã®ãƒ©ãƒ³ãƒã‚¿ã‚¤ãƒ ã¯ã‹ãªã‚Šæ··é›‘ã—ã¾ã™ã€‚æ™‚é–“ã‚’ãšã‚‰ã—ã¦ã„ãã®ãŒå‰ã€‚",rating:4,relative_time_description:"1ãƒ¶æœˆå‰",time:1702684800},{author:"ä¼Šè—¤ç”±ç¾",text:"å“ä¸Šã®é«˜èœãŒç„¡æ–™ã§é£Ÿã¹æ”¾é¡Œãªã®ãŒå¬‰ã—ã„ã€‚ãƒ©ãƒ¼ãƒ¡ãƒ³ã¨ã®ç›¸æ€§ã‚‚æŠœç¾¤ã€‚",rating:5,relative_time_description:"1ãƒ¶æœˆå‰",time:170208e4},{author:"æ¸¡è¾ºæ˜",text:"åº—å“¡ã•ã‚“ã®æ¥å®¢ãŒã¨ã¦ã‚‚ä¸å¯§ã§æ°—æŒã¡ãŒè‰¯ã„ã€‚å‘³ã ã‘ã§ãªãã€ã‚µãƒ¼ãƒ“ã‚¹ã‚‚ç´ æ™´ã‚‰ã—ã„ã€‚",rating:5,relative_time_description:"2ãƒ¶æœˆå‰",time:1699401600},{author:"å±±æœ¬ã•ãã‚‰",text:"éººã®é‡ã¯æ¨™æº–çš„ã€‚ãŸãã•ã‚“é£Ÿã¹ã‚‹äººã¯å¤§ç››ã‚Šã‹æ›¿ãˆç‰ã‚’æ¤œè¨ã™ã‚‹ã¨è‰¯ã„ã‹ã‚‚ã€‚",rating:4,relative_time_description:"2ãƒ¶æœˆå‰",time:1698796800},{author:"ä¸­æ‘å¥å¤ª",text:"é»’ãƒãƒ¼æ²¹ãŒå…¥ã£ãŸã€Œé»’é¾ãƒ©ãƒ¼ãƒ¡ãƒ³ã€ã‚‚é¦™ã°ã—ãã¦ãŠã™ã™ã‚ã€‚",rating:5,relative_time_description:"3ãƒ¶æœˆå‰",time:1696118400},{author:"å°æ—ç›´å­",text:"ãŠåº—ã¯ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼å¸­ã®ã¿ãªã®ã§ã€å¤§äººæ•°ã§ã®è¨ªå•ã«ã¯å‘ãã¾ã›ã‚“ã€‚ä¸€äººã‹äºŒäººã§è¡Œãã®ãŒãƒ™ã‚¹ãƒˆã€‚",rating:3,relative_time_description:"3ãƒ¶æœˆå‰",time:1695513600},{author:"åŠ è—¤æµ©äºŒ",text:"ä½•åº¦æ¥ã¦ã‚‚é£½ããªã„å‘³ã€‚ã“ã‚Œãç‹é“ã®è±šéª¨ãƒ©ãƒ¼ãƒ¡ãƒ³ã€‚",rating:5,relative_time_description:"4ãƒ¶æœˆå‰",time:1692835200}],distance:250,keywords:["è±šéª¨","ã“ã£ã¦ã‚Š","è¡Œåˆ—"],isOpenNow:!0,congestion:"æ··é›‘",accessInfo:"JRæ–°å®¿é§…è¥¿å£ã‹ã‚‰å¾’æ­©5åˆ†",menu:[{name:"ç‰¹è£½é¾ã®å¿ƒãƒ©ãƒ¼ãƒ¡ãƒ³",price:"1,100å††"},{name:"å‘³ç‰ãƒ©ãƒ¼ãƒ¡ãƒ³",price:"950å††"},{name:"ãƒãƒ£ãƒ¼ã‚·ãƒ¥ãƒ¼ä¸¼",price:"350å††"},{name:"é¤ƒå­ (5å€‹)",price:"450å††"},{name:"ãƒ©ã‚¤ã‚¹",price:"150å††"},{name:"ç“¶ãƒ“ãƒ¼ãƒ«",price:"600å††"}],parkingInfo:"è¿‘éš£ã«ã‚³ã‚¤ãƒ³ãƒ‘ãƒ¼ã‚­ãƒ³ã‚°å¤šæ•°æœ‰ã‚Šï¼ˆææºãªã—ï¼‰"},{placeId:"ch-2",name:"é¶ãã° ç™½é·º (Torisoba Shirasagi)",photos:[{small:"https://picsum.photos/seed/ramen2-main/400/300",medium:"https://picsum.photos/seed/ramen2-main/800/600",large:"https://picsum.photos/seed/ramen2-main/1200/900",alt:"é¶ãã°"},{small:"https://picsum.photos/seed/ramen2-side/400/300",medium:"https://picsum.photos/seed/ramen2-side/800/600",large:"https://picsum.photos/seed/ramen2-side/1200/900",alt:"é¶ãƒãƒ "},{small:"https://picsum.photos/seed/ramen2-shop/400/300",medium:"https://picsum.photos/seed/ramen2-shop/800/600",large:"https://picsum.photos/seed/ramen2-shop/1200/900",alt:"ç™½é·ºã®åº—èˆ—å†…è¦³"}],rating:4.8,address:"æ±äº¬éƒ½æ¸‹è°·åŒºé“ç„å‚2-2-2",lat:35.658034,lng:139.699998,hours:"11:30 - 15:00, 17:30 - 21:00",website:"https://example.com/shirasagi",twitterUrl:"https://twitter.com/example_ramen2",reviews:[{author:"ç”°ä¸­ç¾å’²",text:"é¶ã®æ—¨å‘³ãŒå‡ç¸®ã•ã‚ŒãŸã‚¹ãƒ¼ãƒ—ã¯ã€ã‚ã£ã•ã‚Šã—ã¦ã„ã‚‹ã®ã«å¥¥æ·±ã„ã€‚ç´°éººã¨ã®ç›¸æ€§ã‚‚æŠœç¾¤ã€‚å¥³æ€§ä¸€äººã§ã‚‚å…¥ã‚Šã‚„ã™ã„é›°å›²æ°—ã§ã™ã€‚",rating:5,relative_time_description:"3æ—¥å‰",time:1705536e3},{author:"ä¼Šè—¤å¤§è¼”",text:"éå¸¸ã«ä¸Šå“ãªå‘³ã‚ã„ã®ãƒ©ãƒ¼ãƒ¡ãƒ³ã€‚ãƒãƒ£ãƒ¼ã‚·ãƒ¥ãƒ¼ã®ä»£ã‚ã‚Šã«é¶ãƒãƒ ãŒä¹—ã£ã¦ã„ã¦ãƒ˜ãƒ«ã‚·ãƒ¼ã€‚ã‚¹ãƒ¼ãƒ—ã‚’æœ€å¾Œã¾ã§é£²ã¿å¹²ã—ã¦ã—ã¾ã£ãŸã€‚",rating:5,relative_time_description:"1é€±é–“å‰",time:1705104e3},{author:"æ¸¡è¾ºã‚ãã‚‰",text:"é™å®šã®æŸšå­å¡©ãã°ãŒæœ€é«˜ã§ã—ãŸã€‚",rating:5,relative_time_description:"2é€±é–“å‰",time:1704499200},{author:"ä¸­æ‘ã•ã‚„ã‹",text:"åº—å†…ãŒã¨ã¦ã‚‚ç¶ºéº—ã§å¿«é©ã§ã—ãŸã€‚",rating:4,relative_time_description:"3é€±é–“å‰",time:1703894400},{author:"å°æ—å¤ªéƒ",text:"éººã®é‡ãŒå°‘ã—å°‘ãªã‚ã«æ„Ÿã˜ã¾ã—ãŸã€‚",rating:3,relative_time_description:"1ãƒ¶æœˆå‰",time:1702512e3},{author:"æ–‰è—¤ä¸€",text:"ãƒªãƒ”ãƒ¼ãƒˆç¢ºå®šã§ã™ã€‚æ¬¡ã¯ã¤ã‘éººã‚’è©¦ã—ãŸã„ã€‚",rating:5,relative_time_description:"2ãƒ¶æœˆå‰",time:1699228800}],distance:480,keywords:["é¶ç™½æ¹¯","ã‚ã£ã•ã‚Š","ä¸Šå“"],isOpenNow:!1,congestion:"ä¸æ˜",accessInfo:"JRæ¸‹è°·é§…ãƒãƒå…¬å£ã‹ã‚‰å¾’æ­©7åˆ†",menu:[{name:"ç‰¹è£½é¶ãã°ï¼ˆå¡©ï¼‰",price:"1,200å††"},{name:"é¶ãã°ï¼ˆé†¤æ²¹ï¼‰",price:"900å††"},{name:"é¶ç™½æ¹¯ã¤ã‘éºº",price:"1,000å††"}],parkingInfo:"é§è»Šå ´ãªã—ã€‚æ¸‹è°·é§…å‘¨è¾ºã®é§è»Šå ´ã‚’ã”åˆ©ç”¨ãã ã•ã„ã€‚"},{placeId:"ch-3",name:"å‘³å™Œã®æ¥µã¿ (Miso no Kiwami)",photos:[{small:"https://picsum.photos/seed/ramen3-main/400/300",medium:"https://picsum.photos/seed/ramen3-main/800/600",large:"https://picsum.photos/seed/ramen3-main/1200/900",alt:"å‘³å™Œãƒ©ãƒ¼ãƒ¡ãƒ³"},{small:"https://picsum.photos/seed/ramen3-side/400/300",medium:"https://picsum.photos/seed/ramen3-side/800/600",large:"https://picsum.photos/seed/ramen3-side/1200/900",alt:"ãƒã‚¿ãƒ¼ã‚³ãƒ¼ãƒ³ã®ãƒˆãƒƒãƒ”ãƒ³ã‚°"},{small:"https://picsum.photos/seed/ramen3-shop/400/300",medium:"https://picsum.photos/seed/ramen3-shop/800/600",large:"https://picsum.photos/seed/ramen3-shop/1200/900",alt:"å‘³å™Œã®æ¥µã¿ã®åº—èˆ—"},{small:"https://picsum.photos/seed/ramen3-gyoza/400/300",medium:"https://picsum.photos/seed/ramen3-gyoza/800/600",large:"https://picsum.photos/seed/ramen3-gyoza/1200/900",alt:"ã‚µã‚¤ãƒ‰ã®é¤ƒå­"}],rating:4.2,address:"æ±äº¬éƒ½è±Šå³¶åŒºæ±æ± è¢‹3-3-3",lat:35.729458,lng:139.710348,hours:"11:00 - 23:00",website:"https://example.com/kiwami",reviews:[{author:"æ¸¡è¾ºç›´æ¨¹",text:"åŒ—æµ·é“å‡ºèº«è€…ã‚‚å”¸ã‚‹æœ¬æ ¼å‘³å™Œãƒ©ãƒ¼ãƒ¡ãƒ³ã€‚ç‚’ã‚ãŸé‡èœã®é¦™ã°ã—ã•ãŒã‚¹ãƒ¼ãƒ—ã«æº¶ã‘è¾¼ã‚“ã§ã„ã¦æœ€é«˜ã€‚å¤ªã¡ã¢ã‚ŒéººãŒã‚¹ãƒ¼ãƒ—ã«ã‚ˆãçµ¡ã‚€ã€‚",rating:5,relative_time_description:"5æ—¥å‰",time:1705363200},{author:"å±±æœ¬ç”±ç¾",text:"ãƒã‚¿ãƒ¼ã¨ã‚³ãƒ¼ãƒ³ã‚’ãƒˆãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã®ãŒå®šç•ªã€‚å‘³ãŒæ¿ƒã„ã‚ãªã®ã§ã€ãƒ©ã‚¤ã‚¹ã¨ä¸€ç·’ã«é£Ÿã¹ã‚‹ã®ãŒãŠã™ã™ã‚ã§ã™ã€‚ä½“ãŒæ¸©ã¾ã‚Šã¾ã™ã€‚",rating:4,relative_time_description:"1é€±é–“å‰",time:1704931200}],distance:800,keywords:["å‘³å™Œ","æ¿ƒåš","åŒ—æµ·é“"],isOpenNow:!0,congestion:"æ™®é€š",accessInfo:"JRæ± è¢‹é§…æ±å£ã‹ã‚‰å¾’æ­©10åˆ†",menu:[{name:"æ¥µã¿å‘³å™Œãƒ©ãƒ¼ãƒ¡ãƒ³",price:"980å††"},{name:"è¾›å‘³å™Œãƒ©ãƒ¼ãƒ¡ãƒ³",price:"1,050å††"},{name:"é¤ƒå­ã‚»ãƒƒãƒˆ",price:"400å††"}],parkingInfo:"åº—èˆ—è£ã«ææºã‚³ã‚¤ãƒ³ãƒ‘ãƒ¼ã‚­ãƒ³ã‚°æœ‰ã‚Šï¼ˆ200å††å‰²å¼•ï¼‰"},{placeId:"ch-4",name:"ç…®å¹²ã—ä¸­è¯ãã° å‡ª (Niboshi Chuukasoba Nagi)",photos:[{small:"https://picsum.photos/seed/ramen4-main/400/300",medium:"https://picsum.photos/seed/ramen4-main/800/600",large:"https://picsum.photos/seed/ramen4-main/1200/900",alt:"ã™ã”ã„ç…®å¹²ãƒ©ãƒ¼ãƒ¡ãƒ³"},{small:"https://picsum.photos/seed/ramen4-shop/400/300",medium:"https://picsum.photos/seed/ramen4-shop/800/600",large:"https://picsum.photos/seed/ramen4-shop/1200/900",alt:"å‡ªã®åº—èˆ—"}],rating:4.3,address:"æ±äº¬éƒ½åƒä»£ç”°åŒºä¸¸ã®å†…4-4-4",lat:35.681236,lng:139.767125,hours:"10:30 - 22:00",website:"https://example.com/nagi",reviews:[{author:"ä¸­æ‘æ‹“ä¹Ÿ",text:"ç…®å¹²ã—ã®ãƒ‘ãƒ³ãƒãŒã™ã”ã„ï¼å¥½ããªäººã¯ã¨ã“ã¨ã‚“ãƒãƒã‚‹å‘³ã€‚æœ€åˆã¯é©šãã‘ã©ã€ã ã‚“ã ã‚“ã‚¯ã‚»ã«ãªã£ã¦ãã‚‹ã€‚",rating:4,relative_time_description:"2æ—¥å‰",time:1705622400},{author:"å°æ—ã•ã‚„ã‹",text:"ç…®å¹²ã—ã®é¢¨å‘³ãŒã‚¬ãƒ„ãƒ³ã¨ãã¾ã™ã€‚éººã¯å¤ªã‚ã§é£Ÿã¹å¿œãˆã‚ã‚Šã€‚å¥½ã¿ãŒåˆ†ã‹ã‚Œã‚‹å‘³ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ç§ã¯å¤§å¥½ãã§ã™ã€‚",rating:5,relative_time_description:"4æ—¥å‰",time:1705449600}],distance:150,keywords:["ç…®å¹²","é†¤æ²¹","å€‹æ€§çš„"],isOpenNow:!0,congestion:"ç©ºå¸­ã‚ã‚Š",accessInfo:"æ±äº¬ãƒ¡ãƒˆãƒ­å¤§æ‰‹ç”ºé§…ç›´çµ",menu:[{name:"ã™ã”ã„ç…®å¹²ãƒ©ãƒ¼ãƒ¡ãƒ³",price:"900å††"},{name:"å¡©ç…®å¹²ãƒ©ãƒ¼ãƒ¡ãƒ³",price:"900å††"},{name:"ã„ã£ãŸã‚“éºº",price:"150å††"}],parkingInfo:"ãƒ“ãƒ«åœ°ä¸‹é§è»Šå ´åˆ©ç”¨å¯èƒ½ï¼ˆæœ‰æ–™ï¼‰"}],He=({onOpen:n})=>a.jsx("button",{onClick:n,className:"fixed bottom-5 right-5 z-50 flex items-center justify-center w-14 h-14 bg-red-600 text-white rounded-full shadow-lg hover:bg-red-700 transition-transform transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 focus:ring-offset-gray-900","aria-label":"ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’é€ä¿¡",children:a.jsx(Te,{className:"w-7 h-7"})}),Je=({isOpen:n,onClose:e,onSubmit:t})=>{const[s,r]=i.useState("suggestion"),[o,l]=i.useState(""),[u,d]=i.useState(null),[h,p]=i.useState(!1),m=i.useRef(null),f=g=>{if(g.target.files&&g.target.files[0]){const _=g.target.files[0],S=new FileReader;S.onload=R=>{d(R.target?.result)},S.readAsDataURL(_)}},w=i.useCallback(()=>{r("suggestion"),l(""),d(null),m.current&&(m.current.value="")},[]),k=async g=>{if(g.preventDefault(),!o.trim()){alert("è©³ç´°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");return}p(!0);const _={type:s,details:o,screenshot:u||void 0};try{if(!(await fetch("http://localhost:8080/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)})).ok)throw new Error("Server responded with an error");t(_),e()}catch(S){console.error("Failed to submit feedback:",S),alert("ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚å¾Œã§ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚")}finally{p(!1)}};return i.useEffect(()=>{const g=_=>{_.key==="Escape"&&e()};return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[e]),i.useEffect(()=>{n||setTimeout(()=>{w(),p(!1)},300)},[n,w]),n?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 transition-opacity animate-fade-in-fast",onClick:e,role:"dialog","aria-modal":"true","aria-labelledby":"feedback-modal-title",children:a.jsxs("div",{className:"bg-gray-900 rounded-xl shadow-2xl w-full max-w-md m-4 transform transition-transform animate-slide-in-bottom",onClick:g=>g.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-800",children:[a.jsx("h2",{id:"feedback-modal-title",className:"text-xl font-bold text-white",children:"ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’é€ä¿¡"}),a.jsx("button",{onClick:e,className:"p-1 rounded-full text-gray-400 hover:bg-gray-700 hover:text-white transition-colors",children:a.jsx(ae,{className:"w-6 h-6"})})]}),a.jsxs("form",{onSubmit:k,children:[a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®ç¨®é¡"}),a.jsxs("div",{className:"flex space-x-4",children:[a.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[a.jsx("input",{type:"radio",name:"feedbackType",value:"suggestion",checked:s==="suggestion",onChange:g=>r(g.target.value),className:"form-radio h-4 w-4 text-red-500 bg-gray-800 border-gray-600 focus:ring-red-500"}),a.jsx("span",{className:"text-gray-200",children:"ã”æ„è¦‹ãƒ»ã”è¦æœ›"})]}),a.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[a.jsx("input",{type:"radio",name:"feedbackType",value:"bug",checked:s==="bug",onChange:g=>r(g.target.value),className:"form-radio h-4 w-4 text-red-500 bg-gray-800 border-gray-600 focus:ring-red-500"}),a.jsx("span",{className:"text-gray-200",children:"ãƒã‚°å ±å‘Š"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"details",className:"block text-sm font-medium text-gray-300 mb-2",children:"è©³ç´°"}),a.jsx("textarea",{id:"details",value:o,onChange:g=>l(g.target.value),placeholder:"æ”¹å–„ç‚¹ã‚„å•é¡Œç‚¹ãªã©ã€è©³ã—ããŠèã‹ã›ãã ã•ã„ã€‚",className:"w-full p-3 border border-gray-700 rounded-lg shadow-sm focus:ring-2 focus:ring-red-500 transition bg-gray-800 text-white min-h-[120px]",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ (ä»»æ„)"}),u?a.jsxs("div",{className:"relative group",children:[a.jsx("img",{src:u,alt:"Screenshot preview",className:"rounded-lg max-h-40 w-auto"}),a.jsx("button",{type:"button",onClick:()=>{d(null),m.current&&(m.current.value="")},className:"absolute top-2 right-2 bg-black bg-opacity-60 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity","aria-label":"ç”»åƒã‚’å‰Šé™¤",children:a.jsx(ae,{className:"w-4 h-4"})})]}):a.jsxs("button",{type:"button",onClick:()=>m.current?.click(),className:"w-full flex items-center justify-center space-x-2 px-4 py-3 border-2 border-dashed border-gray-600 rounded-lg text-gray-400 hover:border-gray-500 hover:text-gray-300 transition-colors",children:[a.jsx(Ne,{className:"w-5 h-5"}),a.jsx("span",{children:"ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç”»åƒã‚’é¸æŠ"})]}),a.jsx("input",{type:"file",ref:m,onChange:f,className:"hidden",accept:"image/*"})]})]}),a.jsx("div",{className:"px-6 py-4 bg-gray-900/50 border-t border-gray-800 flex justify-end",children:a.jsx("button",{type:"submit",disabled:!o.trim()||h,className:"flex items-center justify-center bg-red-600 text-white font-bold px-6 py-2.5 rounded-lg hover:bg-red-700 transition shadow-md disabled:opacity-50 disabled:cursor-not-allowed w-32",children:h?a.jsx(Fe,{className:"w-5 h-5 animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(Me,{className:"w-5 h-5 mr-2"}),a.jsx("span",{children:"é€ä¿¡ã™ã‚‹"})]})})})]})]})}):null},ze=({message:n,show:e})=>{const[t,s]=i.useState(!1);return i.useEffect(()=>{if(e)s(!0);else{const r=setTimeout(()=>s(!1),300);return()=>clearTimeout(r)}},[e]),t?a.jsxs("div",{className:`fixed top-5 left-1/2 -translate-x-1/2 z-50 flex items-center p-4 mb-4 text-sm font-semibold text-green-100 bg-green-600 rounded-lg shadow-lg transition-all duration-300 ${e?"opacity-100 translate-y-0":"opacity-0 -translate-y-5"}`,role:"alert",children:[a.jsx(Ce,{className:"w-5 h-5 mr-3"}),a.jsx("span",{className:"font-medium",children:n})]}):null};class W{constructor(e="ramensearch_cache"){this.prefix=e}async get(e){try{const t=`${this.prefix}_${e}`,s=localStorage.getItem(t);if(!s)return null;const r=JSON.parse(s);return Date.now()>r.timestamp+r.expiresIn?(localStorage.removeItem(t),null):r.data}catch(t){return console.warn(`Cache get error for key ${e}:`,t),null}}async set(e,t,s=1440*60*1e3){try{const r=`${this.prefix}_${e}`,o={data:t,timestamp:Date.now(),expiresIn:s};localStorage.setItem(r,JSON.stringify(o))}catch(r){if(console.warn(`Cache set error for key ${e}:`,r),r instanceof DOMException&&r.code===22){console.warn("localStorage quota exceeded, clearing old cache"),this.clearExpired();try{const o=`${this.prefix}_${e}`,l={data:t,timestamp:Date.now(),expiresIn:s};localStorage.setItem(o,JSON.stringify(l))}catch(o){console.error("Failed to cache even after cleanup:",o)}}}}async remove(e){const t=`${this.prefix}_${e}`;localStorage.removeItem(t)}async clear(){const e=[];for(let t=0;t<localStorage.length;t++){const s=localStorage.key(t);s?.startsWith(this.prefix)&&e.push(s)}e.forEach(t=>localStorage.removeItem(t))}async clearExpired(){const e=[],t=Date.now();for(let s=0;s<localStorage.length;s++){const r=localStorage.key(s);if(r?.startsWith(this.prefix))try{const o=localStorage.getItem(r);if(o){const l=JSON.parse(o);t>l.timestamp+l.expiresIn&&e.push(r)}}catch{e.push(r)}}return e.forEach(s=>localStorage.removeItem(s)),e.length}getStats(){let e=0,t=0;for(let s=0;s<localStorage.length;s++){const r=localStorage.key(s);if(r?.startsWith(this.prefix)){e++;const o=localStorage.getItem(r);o&&(t+=r.length+o.length)}}return{totalEntries:e,totalSize:t}}}const at=new W("ramensearch_gemini"),b=new W("ramensearch_favorites"),$=new W("ramensearch_visits"),E="user_favorites",z="user_visits",I=365*24*60*60*1e3;class G{async getFavorites(){const e=await b.get(E);return e?e.map(t=>({...t,savedAt:new Date(t.savedAt),lastVisit:t.lastVisit?new Date(t.lastVisit):void 0})):[]}async addToFavorites(e){const t=await this.getFavorites();if(t.findIndex(o=>o.placeId===e.placeId)!==-1){console.log("Shop is already in favorites");return}const r={placeId:e.placeId,name:e.name,address:e.address,rating:e.rating,savedAt:new Date,visitCount:0};t.push(r),await b.set(E,t,I)}async removeFromFavorites(e){const s=(await this.getFavorites()).filter(r=>r.placeId!==e);await b.set(E,s,I)}async isFavorite(e){return(await this.getFavorites()).some(s=>s.placeId===e)}async updateFavoriteNotes(e,t){const s=await this.getFavorites(),r=s.findIndex(o=>o.placeId===e);if(r===-1)throw new Error("Shop not found in favorites");s[r].personal_notes=t,await b.set(E,s,I)}async updateFavoriteTags(e,t){const s=await this.getFavorites(),r=s.findIndex(o=>o.placeId===e);if(r===-1)throw new Error("Shop not found in favorites");s[r].tags=t,await b.set(E,s,I)}async getVisitHistory(){const e=await $.get(z);return e?e.map(t=>({...t,visitDate:new Date(t.visitDate)})).sort((t,s)=>s.visitDate.getTime()-t.visitDate.getTime()):[]}async addVisit(e){const t=await this.getVisitHistory(),s={...e,visitDate:e.visitDate||new Date};t.unshift(s);const r=t.slice(0,100);await $.set(z,r,I),await this.updateVisitCount(e.placeId)}async updateVisitCount(e){const t=await this.getFavorites(),s=t.findIndex(r=>r.placeId===e);if(s!==-1){const o=(await this.getVisitHistory()).filter(l=>l.placeId===e).length;t[s].visitCount=o,t[s].lastVisit=new Date,await b.set(E,t,I)}}async getShopVisits(e){return(await this.getVisitHistory()).filter(s=>s.placeId===e)}async getFavoritesSorted(e="recent"){const t=await this.getFavorites();switch(e){case"recent":return t.sort((s,r)=>r.savedAt.getTime()-s.savedAt.getTime());case"rating":return t.sort((s,r)=>r.rating-s.rating);case"name":return t.sort((s,r)=>s.name.localeCompare(r.name,"ja"));case"visits":return t.sort((s,r)=>(r.visitCount||0)-(s.visitCount||0));default:return t}}async exportUserData(){const[e,t]=await Promise.all([this.getFavorites(),this.getVisitHistory()]);return{favorites:e,visits:t}}async importUserData(e){e.favorites&&await b.set(E,e.favorites,I),e.visits&&await $.set(z,e.visits,I)}async clearAllData(){await Promise.all([b.clear(),$.clear()])}}const ot=new G;class ue{constructor(){throw this.userId="ramensearch_user",new Error("Supabase configuration missing. Please set VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY")}dbFavoriteToApp(e){return{id:e.id,user_id:e.user_id,placeId:e.place_id,name:e.name,address:e.address||"",rating:e.rating||0,savedAt:new Date(e.saved_at),visitCount:e.visit_count,lastVisit:e.last_visit?new Date(e.last_visit):void 0,personal_notes:e.personal_notes||"",tags:e.tags||[],created_at:new Date(e.created_at)}}dbVisitToApp(e){return{id:e.id,user_id:e.user_id,placeId:e.place_id,shop_name:e.shop_name,visitDate:new Date(e.visit_date),rating:e.rating||void 0,notes:e.notes||"",photos:e.photos||[],created_at:new Date(e.created_at)}}async getFavorites(){try{const{data:e,error:t}=await this.supabase.from("favorites").select("*").eq("user_id",this.userId).order("saved_at",{ascending:!1});if(t)throw console.error("Error fetching favorites:",t),t;return(e||[]).map(this.dbFavoriteToApp)}catch(e){return console.error("Failed to get favorites:",e),[]}}async addToFavorites(e){try{if((await supabase.from(TABLES.FAVORITES).select("id").eq("user_id",DEMO_USER_ID).eq("place_id",e.placeId).single()).data){console.log("Shop is already in favorites");return}const s={user_id:DEMO_USER_ID,place_id:e.placeId,name:e.name,address:e.address,rating:e.rating,saved_at:new Date().toISOString(),visit_count:0,last_visit:null,personal_notes:null,tags:null},{error:r}=await supabase.from(TABLES.FAVORITES).insert(s);if(r)throw console.error("Error adding to favorites:",r),r}catch(t){throw console.error("Failed to add to favorites:",t),t}}async removeFromFavorites(e){try{const{error:t}=await supabase.from(TABLES.FAVORITES).delete().eq("user_id",DEMO_USER_ID).eq("place_id",e);if(t)throw console.error("Error removing from favorites:",t),t}catch(t){throw console.error("Failed to remove from favorites:",t),t}}async isFavorite(e){try{const{data:t,error:s}=await supabase.from(TABLES.FAVORITES).select("id").eq("user_id",DEMO_USER_ID).eq("place_id",e).single();return s&&s.code!=="PGRST116"?(console.error("Error checking favorite status:",s),!1):!!t}catch(t){return console.error("Failed to check favorite status:",t),!1}}async updateFavoriteNotes(e,t){try{const{error:s}=await supabase.from(TABLES.FAVORITES).update({personal_notes:t}).eq("user_id",DEMO_USER_ID).eq("place_id",e);if(s)throw console.error("Error updating favorite notes:",s),s}catch(s){throw console.error("Failed to update favorite notes:",s),s}}async updateFavoriteTags(e,t){try{const{error:s}=await supabase.from(TABLES.FAVORITES).update({tags:t}).eq("user_id",DEMO_USER_ID).eq("place_id",e);if(s)throw console.error("Error updating favorite tags:",s),s}catch(s){throw console.error("Failed to update favorite tags:",s),s}}async getVisitHistory(){try{const{data:e,error:t}=await supabase.from(TABLES.VISIT_HISTORY).select("*").eq("user_id",DEMO_USER_ID).order("visit_date",{ascending:!1});if(t)throw console.error("Error fetching visit history:",t),t;return this.transformDatabaseVisitsToApp(e||[])}catch(e){return console.error("Failed to get visit history:",e),[]}}async addVisit(e){try{const t={user_id:DEMO_USER_ID,place_id:e.placeId,shop_name:e.shop_name||"Unknown Shop",visit_date:(e.visitDate||new Date).toISOString(),rating:e.rating||null,notes:e.notes||null,photos:e.photos||null},{error:s}=await supabase.from(TABLES.VISIT_HISTORY).insert(t);if(s)throw console.error("Error adding visit:",s),s;await this.updateVisitCount(e.placeId)}catch(t){throw console.error("Failed to add visit:",t),t}}async getShopVisits(e){try{const{data:t,error:s}=await supabase.from(TABLES.VISIT_HISTORY).select("*").eq("user_id",DEMO_USER_ID).eq("place_id",e).order("visit_date",{ascending:!1});return s?(console.error("Error fetching shop visits:",s),[]):this.transformDatabaseVisitsToApp(t||[])}catch(t){return console.error("Failed to get shop visits:",t),[]}}async getFavoritesSorted(e="recent"){try{let t,s=!1;switch(e){case"recent":t="saved_at";break;case"rating":t="rating";break;case"name":t="name",s=!0;break;case"visits":t="visit_count";break;default:t="saved_at"}const{data:r,error:o}=await supabase.from(TABLES.FAVORITES).select("*").eq("user_id",DEMO_USER_ID).order(t,{ascending:s});return o?(console.error("Error fetching sorted favorites:",o),[]):this.transformDatabaseFavoritesToApp(r||[])}catch(t){return console.error("Failed to get sorted favorites:",t),[]}}async updateVisitCount(e){try{const{count:t,error:s}=await supabase.from(TABLES.VISIT_HISTORY).select("*",{count:"exact",head:!0}).eq("user_id",DEMO_USER_ID).eq("place_id",e);if(s){console.error("Error counting visits:",s);return}const{error:r}=await supabase.from(TABLES.FAVORITES).update({visit_count:t||0,last_visit:new Date().toISOString()}).eq("user_id",DEMO_USER_ID).eq("place_id",e);r&&console.error("Error updating visit count:",r)}catch(t){console.error("Failed to update visit count:",t)}}transformDatabaseFavoritesToApp(e){return e.map(t=>({id:t.id,user_id:t.user_id,placeId:t.place_id,name:t.name,address:t.address,rating:t.rating,savedAt:new Date(t.saved_at),personal_notes:t.personal_notes||void 0,visitCount:t.visit_count,lastVisit:t.last_visit?new Date(t.last_visit):void 0,tags:t.tags||void 0,created_at:new Date(t.created_at)}))}transformDatabaseVisitsToApp(e){return e.map(t=>({id:t.id,user_id:t.user_id,placeId:t.place_id,shop_name:t.shop_name,visitDate:new Date(t.visit_date),rating:t.rating||void 0,notes:t.notes||void 0,photos:t.photos||void 0,created_at:new Date(t.created_at)}))}async exportUserData(){const[e,t]=await Promise.all([this.getFavorites(),this.getVisitHistory()]);return{favorites:e,visits:t}}async clearAllData(){try{await Promise.all([supabase.from(TABLES.FAVORITES).delete().eq("user_id",DEMO_USER_ID),supabase.from(TABLES.VISIT_HISTORY).delete().eq("user_id",DEMO_USER_ID)])}catch(e){throw console.error("Failed to clear user data:",e),e}}}new ue;class Ke{constructor(){this.localService=new G,this.supabaseService=new ue}async migrateToSupabase(){const e={success:!1,favoritesMigrated:0,visitsMigrated:0,errors:[]};try{console.log("Starting data migration from localStorage to Supabase...");const t=await this.localService.exportUserData();if(!t.favorites.length&&!t.visits.length)return console.log("No local data found to migrate"),e.success=!0,e;console.log(`Found ${t.favorites.length} favorites and ${t.visits.length} visits to migrate`);for(const s of t.favorites)try{await this.migrateFavorite(s),e.favoritesMigrated++}catch(r){const o=`Failed to migrate favorite ${s.name}: ${r}`;console.error(o),e.errors.push(o)}for(const s of t.visits)try{await this.migrateVisit(s),e.visitsMigrated++}catch(r){const o=`Failed to migrate visit for ${s.placeId}: ${r}`;console.error(o),e.errors.push(o)}return e.success=e.errors.length===0,console.log("Migration completed:",{favoritesMigrated:e.favoritesMigrated,visitsMigrated:e.visitsMigrated,errors:e.errors.length}),e}catch(t){const s=`Migration failed: ${t}`;return console.error(s),e.errors.push(s),e}}async isMigrationNeeded(){try{const e=await this.localService.exportUserData();if(!e.favorites.length&&!e.visits.length)return!1;const t=await this.supabaseService.exportUserData();return!(t.favorites.length>0||t.visits.length>0)}catch(e){return console.error("Error checking migration status:",e),!1}}async createBackup(){try{return await this.supabaseService.exportUserData()}catch(e){throw console.error("Failed to create backup:",e),e}}async restoreFromBackup(e){try{await this.supabaseService.clearAllData();for(const t of e.favorites)await this.migrateFavorite(t);for(const t of e.visits)await this.migrateVisit(t);console.log("Data restored from backup successfully")}catch(t){throw console.error("Failed to restore from backup:",t),t}}async compareData(){try{const[e,t]=await Promise.all([this.localService.exportUserData(),this.supabaseService.exportUserData()]),s={local:{favorites:e.favorites.length,visits:e.visits.length},supabase:{favorites:t.favorites.length,visits:t.visits.length},differences:[]};return s.local.favorites!==s.supabase.favorites&&s.differences.push(`Favorites count mismatch: local(${s.local.favorites}) vs supabase(${s.supabase.favorites})`),s.local.visits!==s.supabase.visits&&s.differences.push(`Visits count mismatch: local(${s.local.visits}) vs supabase(${s.supabase.visits})`),s}catch(e){throw console.error("Failed to compare data:",e),e}}async migrateFavorite(e){if(await this.supabaseService.isFavorite(e.placeId)){console.log(`Favorite ${e.name} already exists in Supabase, skipping`);return}const s={placeId:e.placeId,name:e.name,address:e.address,rating:e.rating,photos:[],lat:0,lng:0,hours:"",website:"",reviews:[],distance:0,keywords:[],isOpenNow:!1,congestion:"ä¸æ˜",accessInfo:"",menu:[],parkingInfo:""};await this.supabaseService.addToFavorites(s),e.personal_notes&&await this.supabaseService.updateFavoriteNotes(e.placeId,e.personal_notes),e.tags&&e.tags.length>0&&await this.supabaseService.updateFavoriteTags(e.placeId,e.tags)}async migrateVisit(e){await this.supabaseService.addVisit({placeId:e.placeId,shop_name:e.shop_name||"Unknown Shop",visitDate:e.visitDate,rating:e.rating,notes:e.notes,photos:e.photos})}}const N=new Ke,Ye=P.lazy(()=>Y(()=>import("./RamenShopDetail-Da1LbrLU.js"),__vite__mapDeps([0,1,2,3,4]))),We=P.lazy(()=>Y(()=>import("./MyPage-BLBj1JDJ.js"),__vite__mapDeps([5,1,2,6,3,4]))),le=P.lazy(()=>Y(()=>import("./SearchPage-1U4Gp4kz.js"),__vite__mapDeps([7,1,2,6,3,4,8,9])));function Ge(){const[n,e]=i.useState("search"),[t,s]=i.useState(null),[r,o]=i.useState(""),[l,u]=i.useState("distance"),[d,h]=i.useState(""),[p,m]=i.useState(!1),[f,w]=i.useState([]),[k,g]=i.useState(!1),[_,S]=i.useState(!1),[R,X]=i.useState(null),[Q,Z]=i.useState(null),ee=i.useRef(null),[F,me]=i.useState(new Set),[M,he]=i.useState(new Set),[L,ge]=i.useState(new Set),[q,fe]=i.useState([]),[ve,te]=i.useState(!1),[se,re]=i.useState({message:"",show:!1}),B=async(c,v,j)=>{const H=new Set(c);v(x=>{const T=new Set(x);return T.has(j)?T.delete(j):T.add(j),T});try{await new Promise((x,T)=>{setTimeout(()=>{Math.random()>.8?T(new Error("Simulated network error")):x()},500)}),console.log("Update successful for",j)}catch(x){console.error("Optimistic update failed, rolling back:",x),v(H),alert("æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸã€‚å°‘ã—æ™‚é–“ã‚’ãŠã„ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚")}},we=i.useCallback(c=>{B(F,me,c)},[F]),ye=i.useCallback((c,v)=>{v==="visited"?B(M,he,c):B(L,ge,c)},[M,L]),_e=i.useCallback(c=>{fe(v=>[c,...v])},[]),D=c=>{re({message:c,show:!0}),setTimeout(()=>{re({message:"",show:!1})},3e3)};i.useEffect(()=>{window.testDataMigration=async()=>{console.log("ğŸ” Starting data migration test...");try{console.log("ğŸ“‹ Checking if migration is needed...");const c=await N.isMigrationNeeded();console.log(`Migration needed: ${c}`),console.log("âš–ï¸ Comparing local vs Supabase data...");const v=await N.compareData();if(console.log("Data comparison:",v),c){console.log("ğŸš€ Starting migration process...");const H=await N.createBackup();console.log("Backup created:",H);const x=await N.migrateToSupabase();console.log("Migration result:",x),x.success?(console.log("âœ… Migration completed successfully!"),D("ãƒ‡ãƒ¼ã‚¿ç§»è¡ŒãŒå®Œäº†ã—ã¾ã—ãŸï¼")):(console.log("âŒ Migration failed:",x.errors),D("ãƒ‡ãƒ¼ã‚¿ç§»è¡Œã«å¤±æ•—ã—ã¾ã—ãŸ"))}else console.log("â„¹ï¸ No migration needed"),D("ç§»è¡Œã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“");console.log("ğŸ” Final data comparison...");const j=await N.compareData();console.log("Final comparison:",j)}catch(c){console.error("Migration test failed:",c),D("ãƒ†ã‚¹ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ")}},window.checkSupabaseConnection=async()=>{try{const c=await N.compareData();console.log("Supabase connection test:",c),D("æ¥ç¶šãƒ†ã‚¹ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸ")}catch(c){console.error("Connection test failed:",c),D("æ¥ç¶šãƒ†ã‚¹ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ")}},console.log("ğŸ¯ Migration test ready! Call testDataMigration() or checkSupabaseConnection() in console.")},[]);const xe=c=>{console.log("--- Feedback Submitted ---"),console.log("Type:",c.type),console.log("Details:",c.details),console.log("Screenshot (Base64):",c.screenshot?`${c.screenshot.substring(0,50)}...`:"Not provided"),console.log("--------------------------"),D("ã”æ„è¦‹ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼")},A=i.useMemo(()=>{const c=new Map;return Be.forEach(v=>c.set(v.placeId,v)),c},[]),Se=i.useMemo(()=>Array.from(F).map(c=>A.get(c)).filter(Boolean),[F,A]),be=i.useMemo(()=>Array.from(M).map(c=>A.get(c)).filter(Boolean),[M,A]),Ie=i.useMemo(()=>t?q.filter(c=>c.placeId===t.placeId):[],[q,t?.placeId]),De=()=>{if(t)return a.jsx(i.Suspense,{fallback:a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-500"})}),children:a.jsx(Ye,{shop:t,onBack:()=>s(null),isBookmarked:F.has(t.placeId),isVisited:M.has(t.placeId),isFavorite:L.has(t.placeId),onBookmarkToggle:()=>we(t.placeId),onStatusToggle:c=>ye(t.placeId,c),onAddPost:_e,userPosts:Ie})});switch(n){case"search":return a.jsx(i.Suspense,{fallback:a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-500"})}),children:a.jsx(le,{onShopSelect:s,searchTerm:r,setSearchTerm:o,sortKey:l,setSortKey:u,soupTypeFilter:d,setSoupTypeFilter:h,filterOpenNow:p,setFilterOpenNow:m,shops:f,setShops:w,isLocating:k,setIsLocating:g,isFiltering:_,setIsFiltering:S,userLocation:ee,hoveredPlaceId:R,setHoveredPlaceId:X,highlightedPlaceId:Q,setHighlightedPlaceId:Z})});case"mypage":return a.jsx(i.Suspense,{fallback:a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-500"})}),children:a.jsx(We,{bookmarkedShops:Se,visitedShops:be,userPosts:q,onShopSelect:s})});default:return a.jsx(i.Suspense,{fallback:a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-500"})}),children:a.jsx(le,{onShopSelect:s,searchTerm:r,setSearchTerm:o,sortKey:l,setSortKey:u,soupTypeFilter:d,setSoupTypeFilter:h,filterOpenNow:p,setFilterOpenNow:m,shops:f,setShops:w,isLocating:k,setIsLocating:g,isFiltering:_,setIsFiltering:S,userLocation:ee,hoveredPlaceId:R,setHoveredPlaceId:X,highlightedPlaceId:Q,setHighlightedPlaceId:Z})})}};return a.jsxs("div",{className:"flex flex-col min-h-screen bg-gray-950 text-gray-200",children:[a.jsx("header",{className:"bg-gray-900 border-b border-gray-800 text-white shadow-md sticky top-0 z-30",children:a.jsx("div",{className:"container mx-auto max-w-7xl px-4 py-3 flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>{e("search"),s(null)},children:[a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-red-500",children:[a.jsx("path",{d:"M4 21V19C4 17.8954 4.89543 17 6 17H10C11.1046 17 12 17.8954 12 19V21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M12 21V19C12 17.8954 12.8954 17 14 17H18C19.1046 17 20 17.8954 20 19V21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M7 17V11C7 8.23858 9.23858 6 12 6C14.7614 6 17 8.23858 17 11V17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M12 6V3M12 3L10 4M12 3L14 4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),a.jsx("h1",{className:"text-2xl font-bold tracking-wider",children:"Ramen Compass"})]})})}),a.jsx("main",{className:"flex-grow w-full max-w-7xl mx-auto",children:De()}),!t&&a.jsx("footer",{className:"sticky bottom-0 bg-gray-900/80 backdrop-blur-sm border-t border-gray-800 shadow-t-lg z-20",children:a.jsxs("div",{className:"container mx-auto max-w-7xl flex justify-around",children:[a.jsxs("button",{onClick:()=>{e("search"),s(null)},className:`flex flex-col items-center justify-center w-full py-2 text-sm font-medium transition-colors ${n==="search"?"text-red-500":"text-gray-400 hover:text-red-500"}`,children:[a.jsx(Oe,{className:"h-6 w-6 mb-0.5"}),"æ¤œç´¢"]}),a.jsxs("button",{onClick:()=>{e("mypage"),s(null)},className:`flex flex-col items-center justify-center w-full py-2 text-sm font-medium transition-colors ${n==="mypage"?"text-red-500":"text-gray-400 hover:text-red-500"}`,children:[a.jsx(Re,{className:"h-6 w-6 mb-0.5"}),"ãƒã‚¤ãƒšãƒ¼ã‚¸"]})]})}),a.jsx(He,{onOpen:()=>te(!0)}),a.jsx(Je,{isOpen:ve,onClose:()=>te(!1),onSubmit:xe}),a.jsx(ze,{message:se.message,show:se.show})]})}const de="",U="";class Xe{constructor(){this.userId="ramensearch_user",this.localService=new G}isSupabaseConfigured(){return!1}async upsertUserData(e,t){const s=await fetch(`${de}/rest/v1/user_data`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${U}`,apikey:U,Prefer:"resolution=merge-duplicates"},body:JSON.stringify({user_id:this.userId,favorites:e,visited:t,bookmarks:[],user_posts:[]})});if(!s.ok){const r=await s.text();throw new Error(`Failed to upsert user data: ${s.status} ${r}`)}}async getUserData(){const e=await fetch(`${de}/rest/v1/user_data?user_id=eq.${this.userId}&select=*`,{headers:{Authorization:`Bearer ${U}`,apikey:U}});if(!e.ok)throw new Error(`Failed to get user data: ${e.status}`);return(await e.json())[0]||null}async isMigrationNeeded(){try{if(!this.isSupabaseConfigured())return console.log("Supabase not configured, migration not needed"),!1;const e=await this.localService.exportUserData();if(!e.favorites.length&&!e.visits.length)return console.log("No local data found, migration not needed"),!1;const t=await this.getUserData();return t&&(t.favorites.length>0||t.visited.length>0)?(console.log("Supabase already has data, migration not needed"),!1):(console.log(`Migration needed: ${e.favorites.length} favorites, ${e.visits.length} visits`),!0)}catch(e){return console.error("Error checking migration status:",e),!1}}async migrateToSupabase(){const e={success:!1,favoritesMigrated:0,visitsMigrated:0,errors:[]};try{if(console.log("Starting simple migration to Supabase..."),!this.isSupabaseConfigured())return e.errors.push("Supabase not configured"),e;const t=await this.localService.exportUserData();if(!t.favorites.length&&!t.visits.length)return console.log("No data to migrate"),e.success=!0,e;console.log(`Migrating ${t.favorites.length} favorites and ${t.visits.length} visits`);const s=t.favorites.map(o=>({placeId:o.placeId,name:o.name,address:o.address,rating:o.rating,savedAt:o.savedAt.toISOString(),visitCount:o.visitCount||0,lastVisit:o.lastVisit?.toISOString()||null,personal_notes:o.personal_notes||"",tags:o.tags||[]})),r=t.visits.map(o=>({placeId:o.placeId,shop_name:o.shop_name||"Unknown Shop",visitDate:o.visitDate.toISOString(),rating:o.rating||null,notes:o.notes||"",photos:o.photos||[]}));return await this.upsertUserData(s,r),e.favoritesMigrated=s.length,e.visitsMigrated=r.length,e.success=!0,console.log("Migration completed successfully:",{favoritesMigrated:e.favoritesMigrated,visitsMigrated:e.visitsMigrated}),e}catch(t){const s=`Migration failed: ${t}`;return console.error(s),e.errors.push(s),e}}async testConnection(){try{return this.isSupabaseConfigured()?(await this.getUserData(),console.log("Supabase connection test successful"),!0):!1}catch(e){return console.error("Supabase connection test failed:",e),!1}}}const K=new Xe;async function Qe(){console.log("=== RamenSearch Data Migration Test ===");try{if(console.log("1. Testing Supabase connection..."),!await K.testConnection()){console.error("âŒ Supabase connection failed");return}if(console.log("âœ… Supabase connection successful"),console.log("2. Checking if migration is needed..."),!await K.isMigrationNeeded()){console.log("â„¹ï¸ Migration not needed (no local data or already migrated)");return}console.log("âœ… Migration needed"),console.log("3. Executing migration...");const t=await K.migrateToSupabase();return t.success?(console.log("âœ… Migration completed successfully!"),console.log(`   - Favorites migrated: ${t.favoritesMigrated}`),console.log(`   - Visits migrated: ${t.visitsMigrated}`)):(console.error("âŒ Migration failed:"),t.errors.forEach(s=>console.error(`   - ${s}`))),t}catch(n){throw console.error("âŒ Migration test failed:",n),n}}window.runMigrationTest=Qe;class Ze{constructor(){throw this.userId="ramensearch_user",new Error("Supabase configuration missing")}dbFavoriteToApp(e){return{id:e.id,user_id:e.user_id,placeId:e.place_id,name:e.name,address:e.address||"",rating:e.rating||0,savedAt:new Date(e.saved_at),visitCount:e.visit_count,lastVisit:e.last_visit?new Date(e.last_visit):void 0,personal_notes:e.personal_notes||"",tags:e.tags||[],created_at:new Date(e.created_at)}}dbVisitToApp(e){return{id:e.id,user_id:e.user_id,placeId:e.place_id,shop_name:e.shop_name,visitDate:new Date(e.visit_date),rating:e.rating||void 0,notes:e.notes||"",photos:e.photos||[],created_at:new Date(e.created_at)}}async getFavorites(){try{const{data:e,error:t}=await this.supabase.from("favorites").select("*").eq("user_id",this.userId).order("saved_at",{ascending:!1});if(t)throw t;return(e||[]).map(this.dbFavoriteToApp)}catch(e){return console.error("Failed to get favorites:",e),[]}}async addToFavorites(e){try{if(await this.isFavorite(e.placeId))return;const{error:s}=await this.supabase.from("favorites").insert({user_id:this.userId,place_id:e.placeId,name:e.name,address:e.address,rating:e.rating,visit_count:0,personal_notes:"",tags:[]});if(s)throw s}catch(t){throw console.error("Failed to add to favorites:",t),t}}async removeFromFavorites(e){try{const{error:t}=await this.supabase.from("favorites").delete().eq("user_id",this.userId).eq("place_id",e);if(t)throw t}catch(t){throw console.error("Failed to remove from favorites:",t),t}}async isFavorite(e){try{const{data:t,error:s}=await this.supabase.from("favorites").select("id").eq("user_id",this.userId).eq("place_id",e).single();return s&&s.code!=="PGRST116"?!1:!!t}catch{return!1}}async getVisitHistory(){try{const{data:e,error:t}=await this.supabase.from("visit_history").select("*").eq("user_id",this.userId).order("visit_date",{ascending:!1}).limit(100);if(t)throw t;return(e||[]).map(this.dbVisitToApp)}catch(e){return console.error("Failed to get visit history:",e),[]}}async addVisit(e){try{const{error:t}=await this.supabase.from("visit_history").insert({user_id:this.userId,place_id:e.placeId,shop_name:e.shop_name,visit_date:(e.visitDate||new Date).toISOString(),rating:e.rating||null,notes:e.notes||"",photos:e.photos||[]});if(t)throw t;await this.updateVisitCount(e.placeId)}catch(t){throw console.error("Failed to add visit:",t),t}}async updateVisitCount(e){try{const{count:t}=await this.supabase.from("visit_history").select("*",{count:"exact",head:!0}).eq("user_id",this.userId).eq("place_id",e),{data:s}=await this.supabase.from("visit_history").select("visit_date").eq("user_id",this.userId).eq("place_id",e).order("visit_date",{ascending:!1}).limit(1).single();await this.supabase.from("favorites").update({visit_count:t||0,last_visit:s?.visit_date||null,updated_at:new Date().toISOString()}).eq("user_id",this.userId).eq("place_id",e)}catch(t){console.error("Failed to update visit count:",t)}}async exportUserData(){try{const[e,t]=await Promise.all([this.getFavorites(),this.getVisitHistory()]);return{favorites:e,visits:t}}catch(e){return console.error("Failed to export user data:",e),{favorites:[],visits:[]}}}async testConnection(){try{const{error:e}=await this.supabase.from("favorites").select("count",{count:"exact",head:!0}).eq("user_id",this.userId);return!e}catch{return!1}}}const y=new Ze,O={placeId:"test_place_001",name:"ãƒ†ã‚¹ãƒˆãƒ©ãƒ¼ãƒ¡ãƒ³åº—",address:"æ±äº¬éƒ½æ¸‹è°·åŒºãƒ†ã‚¹ãƒˆ1-1-1",rating:4.5,photos:[],lat:35.6586,lng:139.7454,hours:"11:00-22:00",website:"https://test-ramen.com",reviews:[],distance:0,keywords:["ãƒ©ãƒ¼ãƒ¡ãƒ³","ãƒ†ã‚¹ãƒˆ"],isOpenNow:!0,congestion:"æ™®é€š",accessInfo:"JRæ¸‹è°·é§…ã‚ˆã‚Šå¾’æ­©5åˆ†",menu:[],parkingInfo:"è¿‘éš£ã«ã‚³ã‚¤ãƒ³ãƒ‘ãƒ¼ã‚­ãƒ³ã‚°ã‚ã‚Š"};async function et(){console.log("=== æ–°ã—ã„Supabaseãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ãƒ†ã‚¹ãƒˆ ===");try{console.log("1. æ¥ç¶šãƒ†ã‚¹ãƒˆ...");const n=await y.testConnection();if(!n){console.error("âŒ Supabaseæ¥ç¶šå¤±æ•—");return}console.log("âœ… Supabaseæ¥ç¶šæˆåŠŸ"),console.log("2. æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ç¢ºèª...");const e=await y.getFavorites(),t=await y.getVisitHistory();console.log(`   ç¾åœ¨ã®ãŠæ°—ã«å…¥ã‚Š: ${e.length}ä»¶`),console.log(`   ç¾åœ¨ã®è¨ªå•å±¥æ­´: ${t.length}ä»¶`),console.log("3. ãŠæ°—ã«å…¥ã‚Šè¿½åŠ ãƒ†ã‚¹ãƒˆ...");const s=await y.isFavorite(O.placeId);console.log(`   è¿½åŠ å‰ã®çŠ¶æ…‹: ${s?"ãŠæ°—ã«å…¥ã‚Šæ¸ˆã¿":"ãŠæ°—ã«å…¥ã‚Šãªã—"}`),s?console.log("â„¹ï¸ æ—¢ã«ãŠæ°—ã«å…¥ã‚Šç™»éŒ²æ¸ˆã¿"):(await y.addToFavorites(O),console.log("âœ… ãŠæ°—ã«å…¥ã‚Šè¿½åŠ æˆåŠŸ")),console.log("4. ãŠæ°—ã«å…¥ã‚Šç¢ºèª...");const r=await y.isFavorite(O.placeId);console.log(`   ç¢ºèªçµæœ: ${r?"âœ… ãŠæ°—ã«å…¥ã‚Šç™»éŒ²æ¸ˆã¿":"âŒ ãŠæ°—ã«å…¥ã‚Šæœªç™»éŒ²"}`),console.log("5. ãŠæ°—ã«å…¥ã‚Šä¸€è¦§å–å¾—...");const o=await y.getFavorites();if(console.log(`   å–å¾—ä»¶æ•°: ${o.length}ä»¶`),o.length>0){console.log("   æœ€æ–°ã®ãŠæ°—ã«å…¥ã‚Š:");const d=o[0];console.log(`     - ${d.name} (${d.address})`),console.log(`     - è©•ä¾¡: ${d.rating}`),console.log(`     - è¨ªå•å›æ•°: ${d.visitCount}`)}console.log("6. è¨ªå•å±¥æ­´è¿½åŠ ãƒ†ã‚¹ãƒˆ..."),await y.addVisit({placeId:O.placeId,shop_name:O.name,rating:5,notes:"ã¨ã¦ã‚‚ç¾å‘³ã—ã‹ã£ãŸï¼",photos:[]}),console.log("âœ… è¨ªå•å±¥æ­´è¿½åŠ æˆåŠŸ"),console.log("7. è¨ªå•å±¥æ­´ç¢ºèª...");const l=await y.getVisitHistory();if(console.log(`   è¨ªå•å±¥æ­´ä»¶æ•°: ${l.length}ä»¶`),l.length>0){console.log("   æœ€æ–°ã®è¨ªå•:");const d=l[0];console.log(`     - ${d.shop_name}`),console.log(`     - è©•ä¾¡: ${d.rating}`),console.log(`     - ãƒ¡ãƒ¢: ${d.notes}`),console.log(`     - è¨ªå•æ—¥: ${d.visitDate.toLocaleDateString()}`)}console.log("8. ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ†ã‚¹ãƒˆ...");const u=await y.exportUserData();return console.log(`   ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ - ãŠæ°—ã«å…¥ã‚Š: ${u.favorites.length}ä»¶`),console.log(`   ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ - è¨ªå•å±¥æ­´: ${u.visits.length}ä»¶`),console.log(`
ğŸ‰ ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸï¼`),{connectionOk:n,favorites:o.length,visits:l.length,testShopAdded:r}}catch(n){throw console.error("âŒ ãƒ†ã‚¹ãƒˆä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ:",n),n}}window.runSupabaseNewTest=et;const pe=document.getElementById("root");if(!pe)throw new Error("Could not find root element to mount to");const tt=Pe.createRoot(pe);tt.render(a.jsx(P.StrictMode,{children:a.jsx(Ge,{})}));export{Y as _,ot as f,at as g,a as j};
